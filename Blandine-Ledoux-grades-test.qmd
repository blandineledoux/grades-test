---
title: "grades-test-Blandine-Ledoux"
author: "Blandine Ledoux"
format: html
---
# Introduction

## Question 1

```{r}
library(dplyr)
library(readr)
library(tidyr)
grades <- read.csv("grades.csv")
```

# Simple analyses

## Question 2

```{r}

```

## Question 3
```{r}
library(knitr)
unique_students <- grades %>% distinct(id)
num_students <- nrow(unique_students)
unique_students %>% slice_head(n = 5) %>% knitr::kable()
```

## Question 4

```{r}
students <- grades %>% distinct(id, group)
students %>% slice_head(n = 5) %>% knitr::kable()
```

## Question 5

```{r}
library(ggplot2)
grades %>%
  distinct(id, group) %>%
  count(group) %>%
  ggplot(aes(x = factor(group), y = n)) +
  geom_bar(stat = "identity") +
  labs(x = "Group", y = "Number of Students", title = "Number of Students per Group")
```

## Question 6

```{r}
grades %>%
  filter(course == "History of Feudal Japan") %>%
  group_by(group) %>%
  summarize(avg_grade = mean(grade, na.rm = TRUE)) %>%
  ggplot(aes(x = factor(group), y = avg_grade)) +
  geom_col() +
  labs(x = "Group", y = "Average Grade", title = "Average Grades in History of Feudal Japan by Group")
```

## Question 7

```{r}
grades %>%
  ggplot(aes(x = grade, fill = factor(semester))) +
  geom_density(alpha = 0.5) +
  facet_wrap(~ semester) +
  labs(x = "Grade", y = "Density", fill = "Semester", title = "Distribution of Grades by Semester")
```

# Attendance analysis

## Question 8

```{r}
grades_per_student <- grades %>%
  group_by(id, group) %>%
  summarize(
    num_grades = n(),
    min_grade = min(grade),
    max_grade = max(grade),
    avg_grade = mean(grade),
    median_grade = median(grade),
    .groups = "drop"
  )
grades_per_student %>% slice_head(n = 5) %>% knitr::kable()
```

## Question 9

```{r}
bushido_grades <- grades %>%
  filter(course == "Bushido and Samurai Code") %>%
  group_by(id, group) %>%
  summarize(num_bushido_grades = n(), .groups = "drop")
bushido_grades %>% slice_head(n = 5) %>% knitr::kable()
```

## Question 10

```{r}
bushido_grades %>%
  count(num_bushido_grades) %>%
  ggplot(aes(x = num_bushido_grades, y = n)) +
  geom_bar(stat = "identity") +
  labs(x = "Number of Grades", y = "Number of Students", title = "Distribution of Grades in Bushido and Samurai Code")
```

## Question 11

```{r}
bushido_grades %>%
  ggplot(aes(x = factor(group), y = num_bushido_grades)) +
  geom_boxplot() +
  labs(x = "Group", y = "Number of Grades", title = "Number of Grades in Bushido and Samurai Code by Group")
```

# Grade analysis

## Question 12

```{r}
average_grades <- grades %>%
  group_by(id, group, course) %>%
  summarize(avg_grade = round(mean(grade, na.rm = TRUE), 2), .groups = "drop")
average_grades_wide <- average_grades %>%
  pivot_wider(names_from = course, values_from = avg_grade)
average_grades_wide %>% slice_head(n = 5) %>% knitr::kable()
```

